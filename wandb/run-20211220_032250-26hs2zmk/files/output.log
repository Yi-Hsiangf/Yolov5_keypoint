
Shape of passed values is (3051, 6), indices imply (3051, 4)
Overriding model.yaml nc=80 with nc=1
                 from  n    params  module                                  arguments
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 24      [17, 20, 23]  1     21576  models.yolo.Detect                      [1, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
Model Summary: 270 layers, 7027720 parameters, 7027720 gradients, 15.9 GFLOPs
Transferred 343/349 items from yolov5s.pt
Scaled weight_decay = 0.0005
[34m[1moptimizer:[39m[22m SGD with parameter groups 57 weight, 60 weight (no decay), 60 bias
[34m[1mtrain: [39m[22mScanning '/home/data/data/2020_Autumn_key/labels/train.cache' images and labels... 1078 found, 0 missing, 239 empty, 2 corrupted: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1078/1078 [00:00<?, ?it/s]
[34m[1mtrain: [39m[22mWARNING: /home/data/data/2020_Autumn_key/images/train/VID_20201101_102143.mp4#t=144.2.jpg: ignoring corrupt image/label: non-normalized or out of bounds coordinates [     1.1329      1.1329]
[34m[1mtrain: [39m[22mWARNING: /home/data/data/2020_Autumn_key/images/train/VID_20201101_102625.mp4#t=139.5.jpg: ignoring corrupt image/label: non-normalized or out of bounds coordinates [     1.0273      1.0273]
[34m[1mval: [39m[22mScanning '/home/data/data/2020_Autumn_key/labels/val.cache' images and labels... 236 found, 0 missing, 66 empty, 0 corrupted: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 236/236 [00:00<?, ?it/s]
Plotting labels to runs/train/exp13/labels.jpg...
[34m[1mAutoAnchor: [39m[22m5.72 anchors/target, 0.986 Best Possible Recall (BPR). Current anchors are a good fit to dataset ‚úÖ
Image sizes 640 train, 640 val
Using 8 dataloader workers
Logging results to [1mruns/train/exp13
Starting training for 120 epochs...
     Epoch   gpu_mem       box       obj       cls    labels  img_size
  0%|          | 0/34 [00:00<?, ?it/s]
p_key_xy:  tensor([[0.80957, 0.79541],
        [0.79395, 0.80908],
        [0.78711, 0.79395],
        ...,
        [0.78564, 0.80371],
        [0.82031, 0.79248],
        [0.78760, 0.80420]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79688, 0.75928],
        [0.78516, 0.74707],
        [0.79395, 0.77490],
        ...,
        [0.79736, 0.79297],
        [0.78906, 0.76514],
        [0.79883, 0.78809]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.78906, 0.79248],
        [0.79199, 0.78760],
        [0.78223, 0.78809],
        ...,
        [0.79980, 0.79053],
        [0.79932, 0.78711],
        [0.78955, 0.79150]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
lkey loss:  tensor([0.01330], device='cuda:0', grad_fn=<MulBackward0>)
p_key_xy:  tensor([[0.77979, 0.81152],
        [0.78906, 0.79688],
        [0.78955, 0.78564],
        ...,
        [0.81152, 0.80225],
        [0.81445, 0.79590],
        [0.77197, 0.80469]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.80225, 0.75684],
        [0.79736, 0.77832],
        [0.78223, 0.77051],
        ...,
        [0.80078, 0.78516],
        [0.79932, 0.78809],
        [0.80469, 0.79688]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79199, 0.81055],
        [0.79541, 0.80176],
        [0.79443, 0.79150],
        ...,
        [0.80371, 0.77441],
        [0.79736, 0.78076],
        [0.79492, 0.78027]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)

     0/119     8.46G    0.1181   0.03723    0.0133       439      1280:   3%|‚ñé         | 1/34 [00:10<05:41, 10.34s/it]
p_key_xy:  tensor([[0.77930, 0.79004],
        [0.79590, 0.82568],
        [0.81396, 0.77441],
        ...,
        [0.79395, 0.80273],
        [0.79248, 0.80371],
        [0.79004, 0.80762]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.77686, 0.78857],
        [0.81104, 0.77979],
        [0.77783, 0.78857],
        ...,
        [0.78076, 0.77441],
        [0.80078, 0.77490],
        [0.78662, 0.78320]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79346, 0.79004],
        [0.80371, 0.80176],
        [0.79395, 0.79541],
        ...,
        [0.79004, 0.78711],
        [0.79736, 0.79346],
        [0.79102, 0.79785]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
lkey loss:  tensor([0.01319], device='cuda:0', grad_fn=<MulBackward0>)
p_key_xy:  tensor([[0.78857, 0.79736],
        [0.79297, 0.78564],
        [0.77832, 0.78369],
        ...,
        [0.80566, 0.81543],
        [0.79248, 0.79932],
        [0.81055, 0.80908]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.78857, 0.78174],
        [0.75635, 0.78418],
        [0.77441, 0.77881],
        ...,
        [0.78516, 0.78076],
        [0.79102, 0.78809],
        [0.80566, 0.77441]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.78418, 0.79004],
        [0.79883, 0.79443],
        [0.79150, 0.78809],
        ...,
        [0.77246, 0.77930],
        [0.79688, 0.79102],
        [0.81152, 0.78711]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
lkey loss:  tensor([0.01400], device='cuda:0', grad_fn=<MulBackward0>)
p_key_xy:  tensor([[0.81494, 0.80078],
        [0.81738, 0.78760],
        [0.81104, 0.79346],
        ...,
        [0.80127, 0.79785],
        [0.81494, 0.80566],
        [0.80127, 0.80078]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79736, 0.76855],
        [0.76953, 0.78223],
        [0.78760, 0.78076],
        ...,
        [0.78076, 0.78613],
        [0.77637, 0.78857],
        [0.79688, 0.77734]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.80762, 0.79004],
        [0.79102, 0.79785],
        [0.79834, 0.80176],
        ...,
        [0.79639, 0.80273],
        [0.79492, 0.79590],
        [0.79395, 0.77930]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)

     0/119     7.68G    0.1174   0.03464   0.01353       329      1280:  12%|‚ñà‚ñè        | 4/34 [00:12<00:59,  1.97s/it]
p_key_xy:  tensor([[0.79150, 0.79395],
        [0.78809, 0.80371],
        [0.80371, 0.82715],
        ...,
        [0.78662, 0.81738],
        [0.83887, 0.79590],
        [0.81592, 0.80713]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79541, 0.76807],
        [0.80420, 0.76953],
        [0.76807, 0.77393],
        ...,
        [0.79639, 0.77051],
        [0.80469, 0.79492],
        [0.81055, 0.79541]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79248, 0.81006],
        [0.78906, 0.79932],
        [0.78125, 0.78906],
        ...,
        [0.79297, 0.78467],
        [0.79688, 0.78857],
        [0.79688, 0.78320]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
lkey loss:  tensor([0.01302], device='cuda:0', grad_fn=<MulBackward0>)
p_key_xy:  tensor([[0.77148, 0.79150],
        [0.77490, 0.80225],
        [0.80420, 0.78174],
        ...,
        [0.76123, 0.79102],
        [0.77344, 0.79346],
        [0.81738, 0.80225]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.81348, 0.77002],
        [0.77832, 0.76953],
        [0.78857, 0.77881],
        ...,
        [0.79736, 0.78760],
        [0.79346, 0.79004],
        [0.79346, 0.79297]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.78516, 0.79736],
        [0.80811, 0.79492],
        [0.79102, 0.79102],
        ...,
        [0.78906, 0.79248],
        [0.78223, 0.77881],
        [0.79199, 0.78516]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
lkey loss:  tensor([0.01489], device='cuda:0', grad_fn=<MulBackward0>)
p_key_xy:  tensor([[0.76221, 0.80273],
        [0.80225, 0.80225],
        [0.79639, 0.79834],
        ...,
        [0.82959, 0.78613],
        [0.82764, 0.78711],
        [0.80176, 0.79590]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.76562, 0.79980],
        [0.76367, 0.79150],
        [0.77490, 0.79736],
        ...,
        [0.78418, 0.80859],
        [0.78223, 0.78711],
        [0.79150, 0.77783]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79639, 0.79395],
        [0.79102, 0.78027],
        [0.79785, 0.79541],
        ...,
        [0.79492, 0.78467],
        [0.78271, 0.77490],
        [0.78662, 0.77832]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)

     0/119     7.22G     0.116   0.03469   0.01358       403      1280:  21%|‚ñà‚ñà        | 7/34 [00:14<00:27,  1.02s/it]
p_key_xy:  tensor([[0.80176, 0.79639],
        [0.80225, 0.80469],
        [0.77930, 0.79199],
        ...,
        [0.79639, 0.81006],
        [0.81543, 0.81787],
        [0.82227, 0.80029]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.79639, 0.78125],
        [0.77734, 0.77295],
        [0.78418, 0.76611],
        ...,
        [0.79199, 0.78271],
        [0.81055, 0.76514],
        [0.80029, 0.78857]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
p_key_xy:  tensor([[0.81201, 0.80762],
        [0.80518, 0.79102],
        [0.79883, 0.81934],
        ...,
        [0.79346, 0.77979],
        [0.78906, 0.78027],
        [0.78760, 0.77734]], device='cuda:0', dtype=torch.float16, grad_fn=<SigmoidBackward0>)
     0/119     9.36G    0.1156   0.03428   0.01363       338      1280:  24%|‚ñà‚ñà‚ñé       | 8/34 [00:15<00:50,  1.93s/it]
Traceback (most recent call last):
  File "/home/rumex/keypoint_yolo/train.py", line 626, in <module>
    main(opt)
  File "/home/rumex/keypoint_yolo/train.py", line 523, in main
    train(opt.hyp, opt, device, callbacks)
  File "/home/rumex/keypoint_yolo/train.py", line 335, in train
    ema.update(model)
  File "/home/rumex/keypoint_yolo/utils/torch_utils.py", line 311, in update
    for k, v in self.ema.state_dict().items():
  File "/home/rumex/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1310, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  File "/home/rumex/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1310, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  File "/home/rumex/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1310, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  File "/home/rumex/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1307, in state_dict
    self._save_to_state_dict(destination, prefix, keep_vars)
  File "/home/rumex/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1267, in _save_to_state_dict
    destination[prefix + name] = buf if keep_vars else buf.detach()
KeyboardInterrupt